<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seleccionar Asientos</title>
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700,900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="stylesheet" href="../styles/asientos.css">
</head>
<body>
    <div class="header-asientos">
        <button class="volver-btn" id="volver-btn">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none"><path d="M15 18l-6-6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
            AtrÃ¡s
        </button>
        <div class="titulo-header">1. Selecciona tus butacas</div>
        <div class="acciones-header">
            <div class="socio-display" id="socio-display">ðŸ‘¤</div>
            <button class="cerrar-btn" id="cerrar-btn" title="Cerrar">
                &times;
            </button>
        </div>
    </div>
    <div class="espacio-header"></div>
    <main>
        <div class="asientos-layout">
            <div class="info-funcion-col">
                <div id="info-funcion"></div>
            </div>
            <div class="asientos-col">
                <!-- Barra de progreso de pasos -->
                <div class="progreso-pasos">
                    <div class="paso activo">
                        <span class="icono"><i class="fa-solid fa-chair"></i></span>
                        <span class="linea"></span>
                    </div>
                    <div class="paso">
                        <span class="icono"><i class="fa-solid fa-ticket"></i></span>
                        <span class="linea"></span>
                    </div>
                    <div class="paso">
                        <span class="icono"><i class="fa-solid fa-burger"></i></span>
                        <span class="linea"></span>
                    </div>
                    <div class="paso">
                        <span class="icono"><i class="fa-regular fa-rectangle-list"></i></span>
                    </div>
                </div>
                <div id="asientos-container"></div>
            </div>
        </div>
    </main>
    <script type="module" src="../js/asientos.js"></script>
    <script>
        // Manejo de usuario en header
        document.addEventListener('DOMContentLoaded', () => {
            fetch('../../backend/auth/checkSession.php')
                .then(res => res.json())
                .then(data => {
                    const socioDisplay = document.getElementById('socio-display');
                    if (data.loggedIn && data.socio && data.socio.nombre) {
                        const nombre = data.socio.nombre;
                        const iniciales = nombre.split(' ').map(word => word[0]).join('').toUpperCase();
                        socioDisplay.textContent = iniciales;
                    } else {
                        socioDisplay.textContent = 'ðŸ‘¤';
                    }
                });
        });
        // BotÃ³n volver
        document.getElementById('volver-btn').onclick = function() {
            const params = new URLSearchParams(window.location.search);
            const idPelicula = params.get('pelicula');
            if (idPelicula) {
                window.location.href = `peliculaSeleccion.html?pelicula=${idPelicula}`;
            } else {
                window.location.href = 'peliculaSeleccion.html';
            }
        };
        // BotÃ³n cerrar (X) - ahora hace lo mismo que volver
        document.getElementById('cerrar-btn').onclick = function() {
            const params = new URLSearchParams(window.location.search);
            const idPelicula = params.get('pelicula');
            if (idPelicula) {
                window.location.href = `peliculaSeleccion.html?pelicula=${idPelicula}`;
            } else {
                window.location.href = 'peliculaSeleccion.html';
            }
        };
    </script>
</body>
</html>
