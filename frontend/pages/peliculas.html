<!DOCTYPE html>

<!---hola xd no sabia como hacer un comentario en HTML-->
<html lang="es" >
    <head>
        <meta charset="utf-8">
        <meta name="author" content="Willo">
        <meta name="description" content="Esta pagina replica el inicio de la pagina de Cineplanet">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Pel√≠culas</title>
        <link rel="shortcut icon" href="icono-cine.ico" type="image/x-icon">
        <style>
            #contenedorPeliculas {
                display: flex;
                flex-wrap: wrap;
                gap: 20px;
                margin-top: 30px;
            }
            .pelicula-card {
                border: 2px solid #2d2d2d; /* Borde m√°s grueso y oscuro */
                border-radius: 8px;
                padding: 12px;
                margin-bottom: 10px;
                background: #f9f9f9;
                width: 220px;
                box-sizing: border-box;
                display: flex;
                flex-direction: column;
                align-items: center;
            }
            .pelicula-card img {
                width: 180px;
                height: 260px;
                object-fit: cover;
                border-radius: 6px;
                margin-bottom: 10px;
            }
            .pelicula-card h3 {
                margin: 8px 0 6px 0;
                text-align: center;
            }
            .pelicula-card p {
                margin: 2px 0;
                text-align: center;
            }
        </style>
    </head>

    <body>
        <header>
            <a href="../../index.html" target="_self">
                <svg class="logo-cineplanet" width="600" height="385" viewBox="0 0 1752.4 1416.2" xmlns="http://www.w3.org/2000/svg">
                    <g>
                    </g>
                </svg>
            </a>
            <nav>
                <ul>
                    <li><a href="peliculas.html" target="_self">Pel√≠culas</a></li>
                    <li><a href="cines.html" target="_self">Cine</a></li>
                    <li><a href="promociones.html" target="_self">Promociones</a></li>
                    <li><a href="socio.html" target="_self">Socio</a></li>
                    <li><a href="dulceria.html" target="_self">Dulcer√≠a</a></li>
                    <li><a href="corporativo.html" target="_self">Corporativo</a></li>
                    <li><a href="blog.html" target="_blank">Blog</a></li>
                </ul>
                <div class="nav-actions">
                    <button class="buscar-btn" aria-label="Buscar">üîç</button>
                    <button class="socio-btn" aria-label="socio">üë§</button>
                    <button class="ayuda-btn" aria-label="ayuda">‚ùî</button>
                </div>
            </nav>
        </header>
        <main>
            <form id="filtros-peliculas">
                <details id="detalleCiudades">
                    <summary>Seleccionar Ciudad</summary>
                    <div id="contenedorCiudades"></div>
                </details>

                <details id="detalleCines">
                    <summary>Seleccionar Cines</summary>
                    <div id="contenedorCines"></div>
                </details>
                <details id="fecha">
                    <summary>Seleccionar Fecha</summary>
                    <div id="filtro-fecha">
                        <!-- Este contenido se generar√° din√°micamente -->
                    </div>  
                </details>
                <details id="detalleGeneros">
                    <summary>Seleccionar G√©neros</summary>
                    <div id="contenedorGeneros"></div>
                </details>
                
                <details id="detalleIdiomas">
                    <summary>Seleccionar Idiomas</summary>
                    <div id="contenedorIdiomas"></div>
                </details>

                <details id="detalleFormato">
                    <summary>Seleccionar Formato</summary>
                    <div id="contenedorFormato"></div>
                </details>

                <details id="detalleCensura">
                    <summary>Seleccionar Censura</summary>
                    <div id="contenedorCensura"></div>
                </details>
                
            </form>
            <div id="contenedorPeliculas"></div>
        </main>
        <div id="socio-info" style="text-align:right; margin:10px;"></div>
        <!-- Ventana flotante socio -->
        <div id="socio-popup" style="display:none; position:fixed; top:70px; right:30px; background:#fff; border:1px solid #ccc; box-shadow:0 2px 8px #0002; z-index:1000; min-width:220px; padding:16px; border-radius:8px;">
            <div id="socio-popup-content"></div>
        </div>
        <script type="module" src="../js/mostrarPeliculas.js"></script>
        <script >
            let socioData = null;
            fetch('../../backend/auth/checkSession.php')
                .then(res => res.json())
                .then(data => {
                    socioData = data.socio || null;
                    if (data.loggedIn && socioData) {
                        document.getElementById('socio-info').innerHTML =
                            'üë§ Socio: ' + socioData.nombre +
                            ' <button onclick="logout()">Cerrar sesi√≥n</button>';
                    } else {
                        document.getElementById('socio-info').innerHTML =
                            `<a href="login.html?redirect=peliculas.html">Iniciar sesi√≥n</a>`;
                    }
                });

            function logout() {
                fetch('../../backend/auth/logout.php')
                    .then(() => window.location.reload());
            }

            // Ventana flotante socio
            const socioBtn = document.querySelector('.socio-btn');
            const popup = document.getElementById('socio-popup');
            const popupContent = document.getElementById('socio-popup-content');

            socioBtn.addEventListener('click', function() {
                if (popup.style.display === 'block') {
                    popup.style.display = 'none';
                    return;
                }
                if (socioData) {
                    popupContent.innerHTML = `
                        <div style="font-weight:bold; margin-bottom:8px;">${socioData.nombre}</div>
                        <button onclick="window.location.href='beneficios.html'">Mis beneficios</button><br>
                        <button onclick="window.location.href='compras.html'">Mis compras</button><br>
                        <button onclick="window.location.href='datos.html'">Mis datos</button><br>
                        <button onclick="logout()">Cerrar sesi√≥n</button>
                    `;
                } else {
                    popupContent.innerHTML = `
                        <button onclick="window.location.href='login.html?redirect=peliculas.html'">Iniciar sesi√≥n</button><br>
                        <button onclick="window.location.href='registro.html'">Registrar</button>
                    `;
                }
                popup.style.display = 'block';
            });

            // Ocultar popup al hacer click fuera
            document.addEventListener('click', function(e) {
                if (!popup.contains(e.target) && e.target !== socioBtn) {
                    popup.style.display = 'none';
                }
            });
        </script>
    </body>
</html>